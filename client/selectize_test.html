<!DOCTYPE html>

<html>

<head>
	<title>otp.js Leaflet Client</title>


    <script src="../bower_components/jquery/jquery.js"></script>
    <script src="bootstrap.min.js"></script>
    <script src="bootstrap-datepicker.js"></script>
    <script src="bootstrap-timepicker.js"></script>
    <script src="selectize.js"></script>

    
    <link rel="stylesheet" href="bootstrap.min.css" />
    <link rel="stylesheet" href="bootstrap-datepicker.css" />
    <link rel="stylesheet" href="bootstrap-timepicker.css" />
    <link rel="stylesheet" href="selectize.css" />
    <link rel="stylesheet" href="style.css" />

</head>

<body >

    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
            <div class="row-fluid" style="margin: 5px 0px;">
                <select id="select-from" style="width: 100%" placeholder="Start Address"></select>
            </div>
            <div class="row-fluid" style="margin: 5px 0px;">
                <select id="select-to" style="width: 100%"  placeholder="End Address"></select>
            </div>
            <div class="row-fluid">
                <select id="arrive" class="span3" placeholder="Arrive"><option>Arrive</option><option>Depart</option></select>
                
                <div class="input-append bootstrap-timepicker" >
                    <input id="time" type="text" class="input-small">
                    <span class="add-on"><i class="icon-time"></i></span>
                </div>

                <div class="input-append date" id="date" data-date-format="dd-mm-yyyy">
                    <input class="input-small" size="16" type="text" value="09/09/2013"><span class="add-on"><i class="icon-th"></i></span>
                </div>

            
                <form class="form-horizontal">
                  <div class="control-group">
                    <label class="control-label" for="">Travel by: </label>
                     <div class="controls">
                        <select id="mode" class="span12" placeholder="Arrive"><option value="TRANSIT">Transit</option><option value="WALK">Walk only</option><option value="BIKE">Bike only</option><option value="TRANSIT,BIKE">Transit & Bike</option></select>
                    </div>  
                  </div>

                  <div class="control-group">
                    <label class="control-label" for="">Find: </label>
                    <div class="controls">
                        <select id="mode" class="span12" placeholder="Arrive"><option>Quickest trip</option><option>Fewest transfers</option><option>Custom trip</option></select>
                    </div>
                  </div>

                  <div class="control-group">
                    <label class="control-label" for="">Maximum walk: </label>
                    <div class="controls">
                        <select id="mode" class="span12" placeholder="Arrive"><option>1/4 mile</option><option>1/2 mile</option><option>3/4 mile</option><option>1 mile</option></select>
                    </div>
                  </div>
                </form>
            </div>
        </div>
        <div class="span9">
          <!--Body content-->
        </div>
      </div>
    </div>


    <script>

    function swap() {

    }

                $('#date').datepicker();
                $('#time').timepicker();

                var $selectFrom = $('#select-from').selectize({
                    valueField: 'latlon',
                    labelField: 'address',
                    searchField: 'address',
                    loadThrottle: 1000,
                    create: false,
                    render: { option: function(item, escape) {
                            return '<div>' +
                                '<span class="title">' + escape(item.address) + '</span>' +
                                '<span class="description">' + escape(item.city) + ', ' + escape(item.state) + '</span>' +
                            '</div>';
                        }
                    },
                    load: function(query, callback) {
                        if (!query.length) return callback();
                        $.ajax({
                            url: 'http://localhost:9000/q/' + encodeURIComponent(query) + '/' + encodeURIComponent('Washington, DC'),
                            type: 'GET',

                            error: function() {
                                callback();
                            },
                            success: function(res) {
                                //if(res.length == 0)
                                    $selectFrom[0].selectize.clearOptions();
                                //else
                                    var data = new Array();
                                    for(var item in res.slice(0, 10)) {
                                        res[item].latlon = res[item].lat + ',' + res[item].lon;
                                        data.push(res[item]);
                                    }

                                    callback(data);
                            }
                        });
                    }
                });

                var $selectTo = $('#select-to').selectize({
                    valueField: 'address',
                    labelField: 'address',
                    searchField: 'address',
                    loadThrottle: 1000,
                    create: false,
                    render: { option: function(item, escape) {
                            return '<div>' +
                                '<span class="title">' + escape(item.address) + '</span>' +
                                '<span class="description">' + escape(item.city) + ', ' + escape(item.state) + '</span>' +
                            '</div>';
                        }
                    },
                    load: function(query, callback) {
                        if (!query.length) return callback();
                        $.ajax({
                            url: 'http://localhost:9000/q/' + encodeURIComponent(query) + '/' + encodeURIComponent('Washington, DC'),
                            type: 'GET',
                            error: function() {
                                callback();
                            },
                            success: function(res) {
                                //if(res.length == 0)
                                    $selectTo[0].selectize.clearOptions();
                                //else
                                    callback(res.slice(0, 10));
                            }
                        });
                    }
                });

    </script>
</body>

</html>